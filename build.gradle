plugins {
    id("maven-publish")
    id("java-library")
    id("gronk").version("latest.release")
}

group("net.auoeke")
version("4.3.1")

gronk {
    javaVersion(17)
}

java {
    withSourcesJar()
}

compileTestJava {
    options.compilerArgs.add("--enable-preview")
}

repositories {
    mavenCentral()
    maven("https://maven.auoeke.net")
}

dependencies {
    api("net.gudenau.lib:unsafe")

    testImplementation("org.junit.jupiter:junit-jupiter-api")
    testRuntimeOnly("org.junit.jupiter:junit-jupiter-engine")

    testImplementation("org.ow2.asm:asm")
    testImplementation("org.ow2.asm:asm-tree")
    testImplementation("org.openjdk.jol:jol-core")
    testImplementation("net.auoeke:uncheck")
    testImplementation("net.bytebuddy:byte-buddy-agent")
}

test {
    useJUnitPlatform()
}

publishing {
    repositories {
        mavenLocal()

        maven {
            url = "https://maven.auoeke.net"

            credentials {
                username = System.properties["maven.username"]
                password = System.properties["maven.password"]
            }
        }
    }
}
